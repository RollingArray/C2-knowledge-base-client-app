(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{Pmid:function(e,t,i){"use strict";i.r(t),i.d(t,"ProjectActivityReviewPageModule",function(){return Ve});var s=i("ofXK"),r=i("tyNb"),n=i("TEn/"),a=i("Tfoj"),o=i("dWgT"),c=i("YEJG"),l=i("4qs/"),d=i("T7yn"),b=i("UHEk"),p=i("fXoL");let u=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=p.Hb({type:e}),e.\u0275inj=p.Gb({imports:[[s.b,c.a,n.R,d.a,b.a,l.a]]}),e})();var v=i("ksD8"),h=i("0/kf"),m=i("sWve");let y=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=p.Hb({type:e}),e.\u0275inj=p.Gb({imports:[[s.b,c.a,n.R,d.a,b.a,l.a]]}),e})();var g=i("HsOq");let O=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=p.Hb({type:e}),e.\u0275inj=p.Gb({imports:[[s.b,n.R,b.a,l.a,h.a,g.a,y]]}),e})();var I=i("mrSG"),f=i("ZFsI"),_=i("pcCU"),E=i("vGT6"),R=i("1G5W"),N=i("Wbko"),T=i("YinQ"),A=i("iMrC"),C=i("dfv2"),S=i("whyd"),w=i("9IC/"),D=i("tk/3"),K=i("y7ii"),M=i("XEr0");let z=(()=>{class e extends S.a{constructor(e,t,i,s){super(e,t,i,s)}projectActivityReviewerCrud(e){return this.post(`${w.a.PROJECT_ACTIVITY_REVIEWER_CRUD}`,e)}projectActivityReviewUpdate(e){return this.post(`${w.a.PROJECT_ACTIVITY_REVIEW_UPDATE}`,e)}}return e.\u0275fac=function(t){return new(t||e)(p.Sb(D.b),p.Sb(K.a),p.Sb(n.b),p.Sb(M.a))},e.\u0275prov=p.Fb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var V=i("Ppwi"),j=i("Pghi"),U=i("SIl3"),k=i("3Pt+"),L=i("wCMH"),P=i("gtxo");const Y=["dropSelector"],x=["reviewerDropSelector"],H=["dropSelectorBackdrop"];function G(e,t){if(1&e&&p.Kb(0,"app-panel-header",20),2&e){const e=p.Yb();p.bc("panelTitle",e.getUserFullName(e.selectedUser.userFirstName,e.selectedUser.userLastName))("panelIcon",e.stringKey.ICON_SELECT)("panelColor",e.stringKey.COLOR_SUCCESS)("isEventRequired",!1)}}function F(e,t){if(1&e){const e=p.Pb();p.Ob(0,"ion-card"),p.Ob(1,"app-panel-header",21),p.Wb("event",function(){p.gc(e);const i=t.$implicit;return p.Yb().chooseUser(i)}),p.Nb(),p.Kb(2,"app-custom-fields",22),p.Nb()}if(2&e){const e=t.$implicit,i=p.Yb();p.zb(1),p.bc("panelTitle",i.getUserFullName(e.userFirstName,e.userLastName))("panelIcon",i.stringKey.ICON_USER)("panelColor",i.stringKey.COLOR_DARK)("eventIcon",i.stringKey.ICON_ACTIVATE)("isEventRequired",!0),p.zb(1),p.bc("description",e.userEmail)}}let B=(()=>{class e extends N.a{constructor(e,t,i,s,r,n,a,o){super(e),this.alertService=t,this.projectService=i,this.projectActivityReviewerService=s,this.loadingService=r,this.navParams=n,this.animationController=a,this.localStorageService=o,this._selectedUser=null,this._animationDuration=100,this._transitionHeight=-356,this.moduleEnum=T.a,this._activityReviewer=this.navParams.get("data"),this.buildFrom(),this.loadData()}get projectReviewers(){return this._projectReviewers}get selectedUser(){return this._selectedUser}set projectReviewers(e){this._projectReviewers=e}set selectedUser(e){this._selectedUser=e}set dropSelectorTitle(e){this._dropSelectorTitle=e}get dropSelectorTitle(){return this._dropSelectorTitle}ngOnInit(){this.dropSelectorBackdrop.nativeElement.hidden=!0}ngOnDestroy(){super.ngOnDestroy()}loadData(){return Object(I.a)(this,void 0,void 0,function*(){this.loadingService.present(`${E.a.API_REQUEST_MESSAGE_1}`),this.projectService.getProjectRaw({projectId:this._activityReviewer.projectId,userId:this._activityReviewer.userId,rawDataKeys:["projectReviewers"]}).pipe(Object(R.a)(this.unsubscribe)).subscribe(e=>{this.loadingService.dismiss(),e.success&&(this._projectReviewers=e.data.projectReviewers.data)})})}chooseUser(e){this._selectedUser=e,this.formGroup.controls.reviewerUserId.setValue(this._selectedUser.userId),this.closeDropSelector()}buildFrom(){this.formGroup=this.formBuilder.group({reviewerUserId:[this._activityReviewer.reviewerUserId,this.validators().compose([this.validators().required])]})}get userId(){return this.formGroup.get("userId")}submit(){return Object(I.a)(this,void 0,void 0,function*(){this.formGroup.invalid?yield this.alertService.presentBasicAlert(`${this.stringKey.MANDATORY_FIELDS}`):this.submitData()})}buildDataModelToPass(){return{projectId:this._activityReviewer.projectId,userId:this._activityReviewer.userId,activityId:this._activityReviewer.activityId,reviewerUserId:this._selectedUser.userId,operationType:this._activityReviewer.operationType}}submitData(){return Object(I.a)(this,void 0,void 0,function*(){this.loadingService.present(`${this.stringKey.API_REQUEST_MESSAGE_2}`);const e=this.buildDataModelToPass();this.projectActivityReviewerService.projectActivityReviewerCrud(e).pipe(Object(R.a)(this.unsubscribe)).subscribe(e=>Object(I.a)(this,void 0,void 0,function*(){yield this.loadingService.dismiss(),e.success&&(this._modalData={cancelled:!1,operationSubmitted:!0},yield this.presentToast(e.message),yield this.dismissModal())}),e=>Object(I.a)(this,void 0,void 0,function*(){yield this.loadingService.dismiss()}))})}cancelModal(){this._modalData={cancelled:!0,operationSubmitted:!1},this.dismissModal()}dismissModal(){this.modalController.dismiss(this._modalData).then(()=>{this.formGroup.reset()})}openDropSelector(e){return Object(I.a)(this,void 0,void 0,function*(){this.activeDropSelector(e),this.animationController.create().addElement(this.dropSelector.nativeElement).duration(this._animationDuration).fromTo("transform","translateY(0px)",`translateY(${this._transitionHeight}px)`).play()})}activeDropSelector(e){switch(this.dropSelectorBackdrop.nativeElement.hidden=!1,e){case T.a.reviewer:this._dropSelectorTitle=`${this.stringKey.SELECT} ${T.a.reviewer}`,this.reviewerDropSelector.nativeElement.hidden=!1}}closeDropSelector(){return Object(I.a)(this,void 0,void 0,function*(){this.dropSelectorBackdrop.nativeElement.hidden=!0,this.animationController.create().addElement(this.dropSelector.nativeElement).duration(this._animationDuration).fromTo("transform",`translateY(${this._transitionHeight}px)`,"translateY(0px)").play()})}}return e.\u0275fac=function(t){return new(t||e)(p.Jb(p.t),p.Jb(A.a),p.Jb(C.a),p.Jb(z),p.Jb(V.a),p.Jb(n.X),p.Jb(n.c),p.Jb(K.a))},e.\u0275cmp=p.Db({type:e,selectors:[["app-create-edit-project-activity-reviewer"]],viewQuery:function(e,t){if(1&e&&(p.qc(Y,3,p.m),p.qc(x,3,p.m),p.qc(H,3,p.m)),2&e){let e;p.ec(e=p.Xb())&&(t.dropSelector=e.first),p.ec(e=p.Xb())&&(t.reviewerDropSelector=e.first),p.ec(e=p.Xb())&&(t.dropSelectorBackdrop=e.first)}},features:[p.wb],decls:33,vars:13,consts:[[3,"appScrollTracker"],["color","primary"],["slot","start"],["fill","solid","color","dark",3,"click"],["slot","end"],["lines","none","color","primary","scrollEvents","true"],["scrollArea",""],[3,"title","info"],["color","primary","lines","none",3,"formGroup","ngSubmit"],["color","secondary",1,"selector",3,"click"],["color","dark","lines","none"],["slot","start",3,"src"],[3,"panelTitle","panelIcon","panelColor","isEventRequired",4,"ngIf"],[1,"dropSelectorBackdrop",3,"click"],["dropSelectorBackdrop",""],[1,"dropSelector"],["dropSelector",""],["fill","outline",3,"click"],["reviewerDropSelector",""],[4,"ngFor","ngForOf"],[3,"panelTitle","panelIcon","panelColor","isEventRequired"],[3,"panelTitle","panelIcon","panelColor","eventIcon","isEventRequired","event"],[3,"description"]],template:function(e,t){if(1&e&&(p.Ob(0,"ion-header",0),p.Ob(1,"ion-toolbar",1),p.Ob(2,"ion-title"),p.lc(3),p.Nb(),p.Ob(4,"ion-buttons",2),p.Ob(5,"ion-button",3),p.Wb("click",function(){return t.cancelModal()}),p.lc(6),p.Nb(),p.Nb(),p.Ob(7,"ion-buttons",4),p.Ob(8,"ion-button",3),p.Wb("click",function(){return t.submit()}),p.lc(9),p.Nb(),p.Nb(),p.Nb(),p.Nb(),p.Ob(10,"ion-content",5,6),p.Kb(12,"app-page-info-title",7),p.Ob(13,"form",8),p.Wb("ngSubmit",function(){return t.submit()}),p.Ob(14,"ion-card",9),p.Wb("click",function(){return t.openDropSelector(t.moduleEnum.reviewer)}),p.Ob(15,"ion-item",10),p.Kb(16,"ion-icon",11),p.lc(17),p.Nb(),p.kc(18,G,1,4,"app-panel-header",12),p.Nb(),p.Nb(),p.Nb(),p.Ob(19,"div",13,14),p.Wb("click",function(){return t.closeDropSelector()}),p.Nb(),p.Ob(21,"div",15,16),p.Ob(23,"ion-header"),p.Ob(24,"ion-toolbar",1),p.Ob(25,"ion-title",2),p.lc(26),p.Nb(),p.Ob(27,"ion-buttons",4),p.Ob(28,"ion-button",17),p.Wb("click",function(){return t.closeDropSelector()}),p.lc(29),p.Nb(),p.Nb(),p.Nb(),p.Nb(),p.Ob(30,"ion-content",null,18),p.kc(32,F,3,6,"ion-card",19),p.Nb(),p.Nb()),2&e){const e=p.fc(11);p.bc("appScrollTracker",e),p.zb(3),p.nc(" ",t.stringKey.CHOOSE_REVIEWER," "),p.zb(3),p.mc(t.stringKey.CANCEL),p.zb(3),p.mc(t.stringKey.SELECT),p.zb(3),p.bc("title",t.stringKey.CHOOSE_REVIEWER)("info",t.stringKey.PROJECT_REVIEWER_INFO),p.zb(1),p.bc("formGroup",t.formGroup),p.zb(3),p.bc("src",t.stringKey.ICON_REVIEWER),p.zb(1),p.nc(" ",t.stringKey.FORM_INFO_SELECT_REVIEWER," "),p.zb(1),p.bc("ngIf",t.selectedUser),p.zb(8),p.nc(" ",t.dropSelectorTitle," "),p.zb(3),p.mc(t.stringKey.CLOSE),p.zb(3),p.bc("ngForOf",t.projectReviewers)}},directives:[n.u,j.a,n.Q,n.O,n.k,n.j,n.o,U.a,k.m,k.h,k.c,n.l,n.x,n.v,s.j,s.i,L.a,P.a],styles:[".dropSelectorBackdrop[_ngcontent-%COMP%]{position:fixed;width:100%;height:100%;background-color:var(--ion-color-primary);z-index:999;opacity:.6}.dropSelector[_ngcontent-%COMP%]{position:fixed;bottom:-300px;width:100%;height:300px;z-index:1000}p.capitalize[_ngcontent-%COMP%]{text-transform:capitalize}"]}),e})();var W=i("tUwt"),J=i("fGi1"),$=i("xSju"),q=i("NvSi");function Q(e,t){if(1&e&&p.Kb(0,"app-custom-fields",3),2&e){const e=p.Yb();p.bc("data",e.stringKey.MEASUREMENT_TYPE_NUM_INFO)}}function X(e,t){if(1&e&&p.Kb(0,"app-custom-fields",3),2&e){const e=p.Yb();p.bc("data",e.stringKey.MEASUREMENT_TYPE_BOOL_INFO)}}function Z(e,t){if(1&e&&(p.Ob(0,"div",4),p.Ob(1,"table"),p.Ob(2,"tr"),p.Ob(3,"th"),p.lc(4),p.Nb(),p.Ob(5,"th"),p.lc(6),p.Nb(),p.Ob(7,"th"),p.lc(8),p.Nb(),p.Ob(9,"th"),p.lc(10),p.Nb(),p.Ob(11,"th"),p.lc(12),p.Nb(),p.Nb(),p.Ob(13,"tr"),p.Kb(14,"td",5),p.Nb(),p.Ob(15,"tr"),p.Ob(16,"td"),p.lc(17),p.Nb(),p.Ob(18,"td"),p.lc(19),p.Nb(),p.Ob(20,"td"),p.lc(21),p.Nb(),p.Ob(22,"td"),p.lc(23),p.Nb(),p.Ob(24,"td"),p.lc(25),p.Nb(),p.Nb(),p.Ob(26,"tr"),p.Kb(27,"td",5),p.Nb(),p.Nb(),p.Nb()),2&e){const e=p.Yb();p.zb(4),p.mc(e.stringKey.POOR),p.zb(2),p.mc(e.stringKey.IMPROVEMENT),p.zb(2),p.mc(e.stringKey.EXPECTATION),p.zb(2),p.mc(e.stringKey.EXCEED),p.zb(2),p.mc(e.stringKey.OUTSTANDING),p.zb(5),p.oc(" ",e.stringKey.LESS_THAN," ",e.activity.criteriaPoorValue," "),p.zb(2),p.pc(" ",e.stringKey.MORE_THAN_EQUAL," ",e.activity.criteriaPoorValue,", ",e.stringKey.LESS_THAN," ",e.activity.criteriaImprovementValue," "),p.zb(2),p.pc(" ",e.stringKey.MORE_THAN_EQUAL," ",e.activity.criteriaImprovementValue,", ",e.stringKey.LESS_THAN," ",e.activity.criteriaExpectationValue," "),p.zb(2),p.pc(" ",e.stringKey.MORE_THAN_EQUAL," ",e.activity.criteriaExpectationValue,", ",e.stringKey.LESS_THAN," ",e.activity.criteriaExceedValue," "),p.zb(2),p.pc(" ",e.stringKey.MORE_THAN_EQUAL," ",e.activity.criteriaExceedValue,", ",e.stringKey.LESS_THAN_EQUAL," ",e.activity.criteriaOutstandingValue," ")}}let ee=(()=>{class e extends _.a{constructor(e){super(e),this.activityMeasurementTypeEnum=W.a}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(p.Jb(p.t))},e.\u0275cmp=p.Db({type:e,selectors:[["app-measurement-scale"]],inputs:{activity:"activity"},features:[p.wb],decls:5,vars:6,consts:[["eventIcon","stringKey.ICON_MORE",3,"panelTitle","panelIcon","panelColor"],[3,"data",4,"ngIf"],["id","overflow-content",4,"ngIf"],[3,"data"],["id","overflow-content"],["colspan","5"]],template:function(e,t){1&e&&(p.Ob(0,"ion-card"),p.Kb(1,"app-panel-header",0),p.kc(2,Q,1,1,"app-custom-fields",1),p.kc(3,X,1,1,"app-custom-fields",1),p.kc(4,Z,28,23,"div",2),p.Nb()),2&e&&(p.zb(1),p.bc("panelTitle",t.stringKey.ACTIVITY_MEASUREMENT_SCALE)("panelIcon",t.stringKey.ICON_SCALE)("panelColor",t.stringKey.COLOR_MEDIUM),p.zb(1),p.bc("ngIf",t.activity.activityMeasurementType==t.activityMeasurementTypeEnum.Num),p.zb(1),p.bc("ngIf",t.activity.activityMeasurementType==t.activityMeasurementTypeEnum.Bool),p.zb(1),p.bc("ngIf",t.activity.activityMeasurementType==t.activityMeasurementTypeEnum.Num))},directives:[n.l,L.a,s.j,P.a],styles:[""]}),e})();const te=function(){return{standalone:!0}};function ie(e,t){if(1&e){const e=p.Pb();p.Ob(0,"ion-item",15),p.Ob(1,"ion-label",2),p.lc(2),p.Nb(),p.Ob(3,"ion-toggle",20),p.Wb("ngModelChange",function(t){return p.gc(e),p.Yb().isToggled=t})("ionChange",function(t){return p.gc(e),p.Yb().onToggleBtnChange(t)}),p.Nb(),p.Ob(4,"ion-label",4),p.lc(5),p.Nb(),p.Nb()}if(2&e){const e=p.Yb();p.zb(2),p.mc(e.stringKey.NOT_ACHIEVED),p.zb(1),p.bc("ngModel",e.isToggled)("ngModelOptions",p.cc(4,te)),p.zb(2),p.mc(e.stringKey.ACHIEVED)}}function se(e,t){if(1&e&&(p.Ob(0,"ion-range",23),p.Ob(1,"ion-label",2),p.lc(2),p.Nb(),p.Ob(3,"ion-label",4),p.lc(4),p.Nb(),p.Nb()),2&e){const e=p.Yb(2);p.bc("min",e.passedActivity.criteriaPoorValue)("max",e.passedActivity.criteriaOutstandingValue),p.zb(2),p.mc(e.passedActivity.criteriaPoorValue),p.zb(2),p.mc(e.passedActivity.criteriaOutstandingValue)}}function re(e,t){if(1&e&&(p.Ob(0,"ion-range",23),p.Ob(1,"ion-label",2),p.lc(2),p.Nb(),p.Ob(3,"ion-label",4),p.lc(4),p.Nb(),p.Nb()),2&e){const e=p.Yb(2);p.bc("min",e.passedActivity.criteriaOutstandingValue)("max",e.passedActivity.criteriaPoorValue),p.zb(2),p.mc(e.passedActivity.criteriaOutstandingValue),p.zb(2),p.mc(e.passedActivity.criteriaPoorValue)}}function ne(e,t){if(1&e&&(p.Ob(0,"ion-item",15),p.kc(1,se,5,4,"ion-range",21),p.kc(2,re,5,4,"ion-range",21),p.Ob(3,"span",22),p.lc(4),p.Nb(),p.Ob(5,"span",22),p.lc(6),p.Nb(),p.Nb()),2&e){const e=p.Yb();p.zb(1),p.bc("ngIf",e.characteristicsHigherBetter),p.zb(1),p.bc("ngIf",!e.characteristicsHigherBetter),p.zb(2),p.mc(e.claimedResultValue.value),p.zb(2),p.nc("\xa0 ",e.passedActivity.activityResultType,"")}}function ae(e,t){if(1&e&&(p.Ob(0,"ion-card",24),p.Ob(1,"ion-item",24),p.Kb(2,"ion-icon",25),p.lc(3),p.Nb(),p.Nb()),2&e){const e=p.Yb();p.zb(2),p.bc("src",e.stringKey.ICON_WARNING),p.zb(1),p.nc(" ",e.stringKey.FORM_VALIDATION_COMMENT," ")}}let oe=(()=>{class e extends N.a{constructor(e,t,i,s,r){super(e),this.alertService=t,this.projectActivityService=i,this.loadingService=s,this.navParams=r,this._isToggled=!1,this.activityMeasurementTypeEnum=W.a,this._characteristicsHigherBetter=!1}set passedActivity(e){this._passedActivity=e}get passedActivity(){return this._passedActivity}set isToggled(e){this._isToggled=e}get isToggled(){return this._isToggled}set characteristicsHigherBetter(e){this._characteristicsHigherBetter=e}get characteristicsHigherBetter(){return this._characteristicsHigherBetter}ngOnInit(){this._passedActivity=this.navParams.get("data"),this._characteristicsHigherBetter="1"==this._passedActivity.characteristicsHigherBetter.toString(),this.buildFrom()}ngOnDestroy(){super.ngOnDestroy()}get commentDescription(){return this.formGroup.get("commentDescription")}get claimedResultValue(){return this.formGroup.get("claimedResultValue")}buildFrom(){this.formGroup=this.formBuilder.group({commentDescription:[this._passedActivity.commentDescription,this.validators().compose([this.validators().required,this.validators().pattern(this.regex.COMMENT_PATTERN)])],claimedResultValue:[this._passedActivity.claimedResultValue,this.validators().compose([this.validators().required,this.validators().pattern(this.regex.NUMBER_PATTERN)])]}),this.setPassedValueToFrom(),this.mapToggle()}setPassedValueToFrom(){const e=this.formGroup.value;e.commentDescription=this._passedActivity.commentDescription,e.claimedResultValue=this._passedActivity.claimedResultValue}mapToggle(){return Object(I.a)(this,void 0,void 0,function*(){this._passedActivity.activityMeasurementType==this.activityMeasurementTypeEnum.Bool&&(this._isToggled=100==this._passedActivity.claimedResultValue)})}onToggleBtnChange(e){this.formGroup.controls.claimedResultValue.setValue(this._isToggled?100:0)}get pageTitle(){let e;switch(this._passedActivity.operationType){case f.a.Create:e=this.stringKey.ADD_COMMENT;break;case f.a.Edit:e=this.stringKey.UPDATE_COMMENT}return e}buildDataModelToPass(){const e=this.formGroup.value;return{userId:this._passedActivity.userId,projectId:this._passedActivity.projectId,activityId:this._passedActivity.activityId,assigneeUserId:this._passedActivity.assigneeUserId,commentId:this._passedActivity.commentId,commentDescription:e.commentDescription,claimedResultValue:e.claimedResultValue,operationType:this._passedActivity.operationType}}submit(){return Object(I.a)(this,void 0,void 0,function*(){this.formGroup.invalid?yield this.alertService.presentBasicAlert(`${this.stringKey.MANDATORY_FIELDS}`):yield this.submitData()})}getLoadingMessage(){return Object(I.a)(this,void 0,void 0,function*(){return this._passedActivity.operationType===f.a.Delete?`${this.stringKey.API_REQUEST_MESSAGE_6}`:`${this.stringKey.API_REQUEST_MESSAGE_2}`})}delete(){return Object(I.a)(this,void 0,void 0,function*(){const e=yield this.alertController.create({header:this.stringKey.CONFIRM_ACTION,message:this.stringKey.ALERT_DELETE,buttons:[{text:this.stringKey.CANCEL,handler:()=>{}},{text:this.stringKey.YES,handler:()=>Object(I.a)(this,void 0,void 0,function*(){this._passedActivity.operationType=f.a.Delete,yield this.submitData()})}]});yield e.present()})}submitData(){return Object(I.a)(this,void 0,void 0,function*(){this.loadingService.present(yield this.getLoadingMessage());const e=this.buildDataModelToPass();this.projectActivityService.projectActivityCommentCrud(e).pipe(Object(R.a)(this.unsubscribe)).subscribe(e=>Object(I.a)(this,void 0,void 0,function*(){yield this.loadingService.dismiss(),e.success&&(this._modalData={cancelled:!1,operationSubmitted:!0},yield this.presentToast(e.message),this.dismissModal()),this._passedActivity.operationType===f.a.Delete&&this.cancelModal()}),e=>{this.loadingService.dismiss()})})}dismissModal(){this.modalController.dismiss(this._modalData).then(()=>{this.formGroup.reset()})}cancelModal(){this._modalData={cancelled:!0,operationSubmitted:!1},this.dismissModal()}}return e.\u0275fac=function(t){return new(t||e)(p.Jb(p.t),p.Jb(A.a),p.Jb($.a),p.Jb(V.a),p.Jb(n.X))},e.\u0275cmp=p.Db({type:e,selectors:[["app-create-edit-project-activity-comment"]],inputs:{data:"data"},features:[p.wb],decls:35,vars:16,consts:[[3,"appScrollTracker"],["color","primary"],["slot","start"],["fill","solid","color","dark",3,"click"],["slot","end"],["lines","none","color","primary","scrollEvents","true"],["scrollArea",""],[3,"title","info"],["slot","fixed","vertical","bottom","horizontal","end"],["color","dark",3,"click"],[3,"src"],["color","primary","lines","none",3,"formGroup","ngSubmit"],["color","secondary"],["color","secondary","lines","none"],["slot","start",3,"src"],["lines","none","color","light"],["lines","none","color","light",4,"ngIf"],["rows","13","autocomplete","off","formControlName","commentDescription","type","text",3,"placeholder"],["color","warning",4,"ngIf"],["id","dum-height"],["color","primary",3,"ngModel","ngModelOptions","ngModelChange","ionChange"],["formControlName","claimedResultValue","color","primary","step","1",3,"min","max",4,"ngIf"],[1,"percentage"],["formControlName","claimedResultValue","color","primary","step","1",3,"min","max"],["color","warning"],["color","danger","slot","start",3,"src"]],template:function(e,t){if(1&e&&(p.Ob(0,"ion-header",0),p.Ob(1,"ion-toolbar",1),p.Ob(2,"ion-title"),p.lc(3),p.Nb(),p.Ob(4,"ion-buttons",2),p.Ob(5,"ion-button",3),p.Wb("click",function(){return t.cancelModal()}),p.lc(6),p.Nb(),p.Nb(),p.Ob(7,"ion-buttons",4),p.Ob(8,"ion-button",3),p.Wb("click",function(){return t.submit()}),p.lc(9),p.Nb(),p.Nb(),p.Nb(),p.Nb(),p.Ob(10,"ion-content",5,6),p.Kb(12,"app-page-info-title",7),p.Ob(13,"ion-fab",8),p.Ob(14,"ion-fab-button",9),p.Wb("click",function(){return t.submit()}),p.Kb(15,"ion-icon",10),p.Nb(),p.Nb(),p.Ob(16,"form",11),p.Wb("ngSubmit",function(){return t.submit()}),p.Ob(17,"ion-card",12),p.Ob(18,"p"),p.Ob(19,"ion-item",13),p.Kb(20,"ion-icon",14),p.lc(21),p.Nb(),p.Nb(),p.Ob(22,"ion-card",15),p.kc(23,ie,6,5,"ion-item",16),p.kc(24,ne,7,4,"ion-item",16),p.Nb(),p.Nb(),p.Ob(25,"ion-card",12),p.Ob(26,"p"),p.Ob(27,"ion-item",13),p.Kb(28,"ion-icon",14),p.lc(29),p.Nb(),p.Nb(),p.Ob(30,"ion-card",15),p.Ob(31,"ion-item",15),p.Kb(32,"ion-textarea",17),p.Nb(),p.kc(33,ae,4,2,"ion-card",18),p.Nb(),p.Nb(),p.Nb(),p.Kb(34,"div",19),p.Nb()),2&e){const e=p.fc(11);p.bc("appScrollTracker",e),p.zb(3),p.nc(" ",t.pageTitle," "),p.zb(3),p.mc(t.stringKey.CANCEL),p.zb(3),p.mc(t.stringKey.SAVE),p.zb(3),p.bc("title",t.pageTitle)("info",t.stringKey.COMMENT_INFO),p.zb(3),p.bc("src",t.stringKey.ICON_SAVE),p.zb(1),p.bc("formGroup",t.formGroup),p.zb(4),p.bc("src",t.stringKey.ICON_SLIDER),p.zb(1),p.nc(" ",t.stringKey.FORM_INFO_ASSIGNEE_ACTIVITY_CLAIM_FACT," "),p.zb(2),p.bc("ngIf",t.passedActivity.activityMeasurementType==t.activityMeasurementTypeEnum.Bool),p.zb(1),p.bc("ngIf",t.passedActivity.activityMeasurementType==t.activityMeasurementTypeEnum.Num),p.zb(4),p.bc("src",t.stringKey.ICON_CREATE),p.zb(1),p.nc(" ",t.stringKey.FORM_INFO_ACTIVITY_ASSIGNEE_COMMENT," "),p.zb(3),p.bc("placeholder",t.stringKey.FORM_PLACEHOLDER_COMMENT),p.zb(1),p.bc("ngIf",t.commentDescription.invalid&&t.commentDescription.touched)}},directives:[n.u,j.a,n.Q,n.O,n.k,n.j,n.o,U.a,n.q,n.r,n.v,k.m,k.h,k.c,n.l,n.x,s.j,n.N,n.cb,k.g,k.b,n.y,n.P,n.d,k.j,n.E,n.bb],styles:[""]}),e})();var ce=i("8yqH");function le(e,t){if(1&e&&p.Kb(0,"app-no-data",8),2&e){const e=p.Yb();p.bc("comment",!0)("text",e.stringKey.NO_DATA_COMMENT)}}function de(e,t){if(1&e&&p.Kb(0,"app-custom-fields",9),2&e){const e=p.Yb();p.bc("data",e.showResult(e.activity))}}function be(e,t){if(1&e&&(p.Ob(0,"ion-card"),p.Kb(1,"app-work-progress",10),p.Nb()),2&e){const e=p.Yb();p.zb(1),p.bc("activity",e.activity)("resultValue",e.activity.claimedResultValue)}}function pe(e,t){1&e&&p.Kb(0,"app-custom-fields",11),2&e&&p.bc("noData",!0)}function ue(e,t){if(1&e&&p.Kb(0,"app-custom-fields",9),2&e){const e=p.Yb();p.bc("data",e.activity.commentDescription)}}function ve(e,t){1&e&&p.Kb(0,"app-custom-fields",11),2&e&&p.bc("noData",!0)}let he=(()=>{class e extends _.a{constructor(e,t,i){super(e),this.localStorageService=t,this.alertService=i,this.event=new p.o}ngOnInit(){this.activeUserId(),this._projectId=this.activatedRoute.snapshot.paramMap.get("projectId")}ngOnDestroy(){super.ngOnDestroy()}activeUserId(){return Object(I.a)(this,void 0,void 0,function*(){this.localStorageService.getActiveUserId().pipe(Object(R.a)(this.unsubscribe)).subscribe(e=>{this._loggedInUser=e})})}showResult(e){return e.activityMeasurementType==W.a.Bool?this.stringKey.ACHIEVED:`${e.claimedResultValue.toString()} ${e.activityResultType}`}openActivityCommentOptions(e){return Object(I.a)(this,void 0,void 0,function*(){const t=yield this.actionSheetController.create({header:this.stringKey.CHOOSE_YOUR_ACTION,buttons:[{text:this.stringKey.EDIT+" "+this.stringKey.DETAILS,icon:this.stringKey.ICON_EDIT,handler:()=>{e.commentId?this.editActivityComment(e,`${f.a.Edit}`):this.addActivityComment(e)}},{text:this.stringKey.CANCEL,icon:this.stringKey.ICON_CANCEL,handler:()=>{}}]});yield t.present()})}addActivityComment(e){return Object(I.a)(this,void 0,void 0,function*(){if(this._loggedInUser==e.assigneeUserId){const t={userId:this._loggedInUser,projectId:this._projectId,assigneeUserId:e.assigneeUserId,activityId:e.activityId,commentDescription:e.commentDescription,claimedResultValue:e.claimedResultValue,activityMeasurementType:e.activityMeasurementType,activityResultType:e.activityResultType,criteriaPoorValue:e.criteriaPoorValue,criteriaOutstandingValue:e.criteriaOutstandingValue,characteristicsHigherBetter:e.characteristicsHigherBetter,operationType:`${f.a.Create}`},i=yield this.modalController.create({component:oe,componentProps:{data:t}});return i.onDidDismiss().then(e=>{this._modalData=e.data,this._modalData.cancelled||this.event.emit()}),yield i.present()}this.alertService.presentBasicAlert(this.stringKey.ALERT_NO_SAME_USER)})}editActivityComment(e,t){return Object(I.a)(this,void 0,void 0,function*(){if(this._loggedInUser==e.assigneeUserId){const i={userId:this._loggedInUser,projectId:this._projectId,assigneeUserId:e.assigneeUserId,activityId:e.activityId,commentId:e.commentId,commentDescription:e.commentDescription,claimedResultValue:e.claimedResultValue,activityMeasurementType:e.activityMeasurementType,activityResultType:e.activityResultType,criteriaPoorValue:e.criteriaPoorValue,criteriaOutstandingValue:e.criteriaOutstandingValue,characteristicsHigherBetter:e.characteristicsHigherBetter,operationType:t},s=yield this.modalController.create({component:oe,componentProps:{data:i}});return s.onDidDismiss().then(e=>{this._modalData=e.data,this._modalData.cancelled||this.event.emit()}),yield s.present()}this.alertService.presentBasicAlert(this.stringKey.ALERT_NO_SAME_USER)})}}return e.\u0275fac=function(t){return new(t||e)(p.Jb(p.t),p.Jb(K.a),p.Jb(A.a))},e.\u0275cmp=p.Db({type:e,selectors:[["app-assignee-self-review"]],inputs:{activity:"activity",allowAction:"allowAction"},outputs:{event:"event"},features:[p.wb],decls:17,vars:20,consts:[[3,"panelTitle","panelIcon","panelColor","eventIcon","isEventRequired","event"],[3,"panelTitle","panelIcon","panelColor"],[3,"comment","text",4,"ngIf"],["size-lg","4","size-md","4","size-sm","4","size","12"],[3,"data",4,"ngIf"],[4,"ngIf"],[3,"noData",4,"ngIf"],["size-lg","8","size-md","8","size-sm","8","size","12"],[3,"comment","text"],[3,"data"],[3,"activity","resultValue"],[3,"noData"]],template:function(e,t){1&e&&(p.Ob(0,"ion-card"),p.Ob(1,"app-panel-header",0),p.Wb("event",function(){return t.openActivityCommentOptions(t.activity)}),p.Nb(),p.Kb(2,"app-panel-header",1),p.kc(3,le,1,2,"app-no-data",2),p.Ob(4,"ion-grid"),p.Ob(5,"ion-row"),p.Ob(6,"ion-col",3),p.Ob(7,"ion-card"),p.Kb(8,"app-panel-header",1),p.kc(9,de,1,1,"app-custom-fields",4),p.kc(10,be,2,2,"ion-card",5),p.kc(11,pe,1,1,"app-custom-fields",6),p.Nb(),p.Nb(),p.Ob(12,"ion-col",7),p.Ob(13,"ion-card"),p.Kb(14,"app-panel-header",1),p.kc(15,ue,1,1,"app-custom-fields",4),p.kc(16,ve,1,1,"app-custom-fields",6),p.Nb(),p.Nb(),p.Nb(),p.Nb(),p.Nb()),2&e&&(p.zb(1),p.bc("panelTitle",t.stringKey.ASSIGNEE_SELF_REVIEW)("panelIcon",t.stringKey.ICON_SELF_REVIEW)("panelColor",t.stringKey.COLOR_MEDIUM)("eventIcon",t.stringKey.ICON_MORE)("isEventRequired",t.allowAction),p.zb(1),p.bc("panelTitle",t.getUserFullName(t.activity.assigneeUserFirstName,t.activity.assigneeUserLastName))("panelIcon",t.stringKey.ICON_USER)("panelColor",t.stringKey.COLOR_LIGHT),p.zb(1),p.bc("ngIf",!t.activity.commentDescription),p.zb(5),p.bc("panelTitle",t.stringKey.ACHIEVED_RESULT)("panelIcon",t.stringKey.ICON_CLAIM_RESULT)("panelColor",t.stringKey.COLOR_LIGHT),p.zb(1),p.bc("ngIf",t.activity.claimedResultValue),p.zb(1),p.bc("ngIf",t.activity.claimedResultValue),p.zb(1),p.bc("ngIf",!t.activity.claimedResultValue),p.zb(3),p.bc("panelTitle",t.stringKey.ASSIGNEE_COMMENT)("panelIcon",t.stringKey.ICON_COMMENT)("panelColor",t.stringKey.COLOR_LIGHT),p.zb(1),p.bc("ngIf",t.activity.commentDescription),p.zb(1),p.bc("ngIf",!t.activity.commentDescription))},directives:[n.l,L.a,s.j,n.t,n.I,n.n,q.a,P.a,ce.a],styles:[""]}),e})();const me=function(){return{standalone:!0}};function ye(e,t){if(1&e){const e=p.Pb();p.Ob(0,"ion-item",15),p.Ob(1,"ion-label",2),p.lc(2),p.Nb(),p.Ob(3,"ion-toggle",20),p.Wb("ngModelChange",function(t){return p.gc(e),p.Yb().isToggled=t})("ionChange",function(t){return p.gc(e),p.Yb().onToggleBtnChange(t)}),p.Nb(),p.Ob(4,"ion-label",4),p.lc(5),p.Nb(),p.Nb()}if(2&e){const e=p.Yb();p.zb(2),p.mc(e.stringKey.NOT_ACHIEVED),p.zb(1),p.bc("ngModel",e.isToggled)("ngModelOptions",p.cc(4,me)),p.zb(2),p.mc(e.stringKey.ACHIEVED)}}function ge(e,t){if(1&e&&(p.Ob(0,"ion-range",23),p.Ob(1,"ion-label",2),p.lc(2),p.Nb(),p.Ob(3,"ion-label",4),p.lc(4),p.Nb(),p.Nb()),2&e){const e=p.Yb(2);p.bc("min",e.passedActivityReview.criteriaPoorValue)("max",e.passedActivityReview.criteriaOutstandingValue),p.zb(2),p.mc(e.passedActivityReview.criteriaPoorValue),p.zb(2),p.mc(e.passedActivityReview.criteriaOutstandingValue)}}function Oe(e,t){if(1&e&&(p.Ob(0,"ion-range",23),p.Ob(1,"ion-label",2),p.lc(2),p.Nb(),p.Ob(3,"ion-label",4),p.lc(4),p.Nb(),p.Nb()),2&e){const e=p.Yb(2);p.bc("min",e.passedActivityReview.criteriaOutstandingValue)("max",e.passedActivityReview.criteriaPoorValue),p.zb(2),p.mc(e.passedActivityReview.criteriaOutstandingValue),p.zb(2),p.mc(e.passedActivityReview.criteriaPoorValue)}}function Ie(e,t){if(1&e&&(p.Ob(0,"ion-item",15),p.kc(1,ge,5,4,"ion-range",21),p.kc(2,Oe,5,4,"ion-range",21),p.Ob(3,"span",22),p.lc(4),p.Nb(),p.Ob(5,"span",22),p.lc(6),p.Nb(),p.Nb()),2&e){const e=p.Yb();p.zb(1),p.bc("ngIf",e.characteristicsHigherBetter),p.zb(1),p.bc("ngIf",!e.characteristicsHigherBetter),p.zb(2),p.mc(e.achievedResultValue.value),p.zb(2),p.nc("\xa0 ",e.passedActivityReview.activityResultType,"")}}function fe(e,t){if(1&e&&(p.Ob(0,"ion-card",24),p.Ob(1,"ion-item",24),p.Kb(2,"ion-icon",25),p.lc(3),p.Nb(),p.Nb()),2&e){const e=p.Yb();p.zb(2),p.bc("src",e.stringKey.ICON_WARNING),p.zb(1),p.nc(" ",e.stringKey.FORM_VALIDATION_COMMENT," ")}}let _e=(()=>{class e extends N.a{constructor(e,t,i,s,r,n){super(e),this.alertService=t,this.projectActivityService=i,this.projectActivityReviewerService=s,this.loadingService=r,this.navParams=n,this.activityMeasurementTypeEnum=W.a,this._isToggled=!1,this._characteristicsHigherBetter=!1}set passedActivityReview(e){this._passedActivityReview=e}get passedActivityReview(){return this._passedActivityReview}set isToggled(e){this._isToggled=e}get isToggled(){return this._isToggled}set characteristicsHigherBetter(e){this._characteristicsHigherBetter=e}get characteristicsHigherBetter(){return this._characteristicsHigherBetter}ngOnInit(){this._passedActivityReview=this.navParams.get("data"),console.log(this._passedActivityReview),this._characteristicsHigherBetter="1"==this._passedActivityReview.characteristicsHigherBetter.toString(),this.buildFrom()}ngOnDestroy(){super.ngOnDestroy()}get achievedResultValue(){return this.formGroup.get("achievedResultValue")}get reviewerComment(){return this.formGroup.get("reviewerComment")}buildFrom(){return Object(I.a)(this,void 0,void 0,function*(){this.formGroup=this.formBuilder.group({achievedResultValue:[this._passedActivityReview.achievedResultValue,this.validators().compose([this.validators().required,this.validators().pattern(this.regex.NUMBER_PATTERN)])],reviewerComment:[this._passedActivityReview.reviewerComment,this.validators().compose([this.validators().required,this.validators().pattern(this.regex.COMMENT_PATTERN)])]}),this.setPassedValueToFrom(),yield this.mapToggle()})}setPassedValueToFrom(){const e=this.formGroup.value;e.reviewerComment=this._passedActivityReview.reviewerComment,e.achievedResultValue=this._passedActivityReview.achievedResultValue}mapToggle(){return Object(I.a)(this,void 0,void 0,function*(){this._passedActivityReview.activityMeasurementType==this.activityMeasurementTypeEnum.Bool&&(this._isToggled=100==this._passedActivityReview.achievedResultValue)})}buildDataModelToPass(){const e=this.formGroup.value;return{userId:this._passedActivityReview.userId,projectId:this._passedActivityReview.projectId,activityId:this._passedActivityReview.activityId,activityReviewId:this._passedActivityReview.activityReviewId,reviewerUserId:this._passedActivityReview.reviewerUserId,reviewerComment:e.reviewerComment,achievedResultValue:e.achievedResultValue,operationType:this._passedActivityReview.operationType}}submit(){return Object(I.a)(this,void 0,void 0,function*(){this.formGroup.invalid?yield this.alertService.presentBasicAlert(`${this.stringKey.MANDATORY_FIELDS}`):yield this.submitData()})}getLoadingMessage(){return Object(I.a)(this,void 0,void 0,function*(){return this._passedActivityReview.operationType===f.a.Delete?`${this.stringKey.API_REQUEST_MESSAGE_6}`:`${this.stringKey.API_REQUEST_MESSAGE_2}`})}delete(){return Object(I.a)(this,void 0,void 0,function*(){const e=yield this.alertController.create({header:this.stringKey.CONFIRM_ACTION,message:this.stringKey.ALERT_DELETE,buttons:[{text:this.stringKey.CANCEL,handler:()=>{}},{text:this.stringKey.YES,handler:()=>Object(I.a)(this,void 0,void 0,function*(){this._passedActivityReview.operationType=f.a.Delete,yield this.submitData()})}]});yield e.present()})}submitData(){return Object(I.a)(this,void 0,void 0,function*(){this.loadingService.present(`${this.stringKey.API_REQUEST_MESSAGE_2}`);const e=this.buildDataModelToPass();this.projectActivityReviewerService.projectActivityReviewUpdate(e).pipe(Object(R.a)(this.unsubscribe)).subscribe(e=>Object(I.a)(this,void 0,void 0,function*(){yield this.loadingService.dismiss(),e.success&&(this._modalData={cancelled:!1,operationSubmitted:!0},yield this.presentToast(e.message),this.dismissModal())}),e=>{this.loadingService.dismiss()})})}onToggleBtnChange(e){this.formGroup.controls.achievedResultValue.setValue(this._isToggled?100:0)}dismissModal(){this.modalController.dismiss(this._modalData).then(()=>{this.formGroup.reset()})}cancelModal(){this._modalData={cancelled:!0,operationSubmitted:!1},this.dismissModal()}}return e.\u0275fac=function(t){return new(t||e)(p.Jb(p.t),p.Jb(A.a),p.Jb($.a),p.Jb(z),p.Jb(V.a),p.Jb(n.X))},e.\u0275cmp=p.Db({type:e,selectors:[["app-create-edit-project-activity-review"]],inputs:{data:"data"},features:[p.wb],decls:35,vars:16,consts:[[3,"appScrollTracker"],["color","primary"],["slot","start"],["fill","solid","color","dark",3,"click"],["slot","end"],["lines","none","color","primary","scrollEvents","true"],["scrollArea",""],[3,"title","info"],["slot","fixed","vertical","bottom","horizontal","end"],["color","dark",3,"click"],[3,"src"],["color","primary","lines","none",3,"formGroup","ngSubmit"],["color","secondary"],["color","secondary","lines","none"],["slot","start",3,"src"],["lines","none","color","light"],["lines","none","color","light",4,"ngIf"],["rows","5","autocomplete","off","formControlName","reviewerComment","type","text",3,"placeholder"],["color","warning",4,"ngIf"],["id","dum-height"],["color","primary",3,"ngModel","ngModelOptions","ngModelChange","ionChange"],["formControlName","achievedResultValue","color","primary","step","1",3,"min","max",4,"ngIf"],[1,"percentage"],["formControlName","achievedResultValue","color","primary","step","1",3,"min","max"],["color","warning"],["color","danger","slot","start",3,"src"]],template:function(e,t){if(1&e&&(p.Ob(0,"ion-header",0),p.Ob(1,"ion-toolbar",1),p.Ob(2,"ion-title"),p.lc(3),p.Nb(),p.Ob(4,"ion-buttons",2),p.Ob(5,"ion-button",3),p.Wb("click",function(){return t.cancelModal()}),p.lc(6),p.Nb(),p.Nb(),p.Ob(7,"ion-buttons",4),p.Ob(8,"ion-button",3),p.Wb("click",function(){return t.submit()}),p.lc(9),p.Nb(),p.Nb(),p.Nb(),p.Nb(),p.Ob(10,"ion-content",5,6),p.Kb(12,"app-page-info-title",7),p.Ob(13,"ion-fab",8),p.Ob(14,"ion-fab-button",9),p.Wb("click",function(){return t.submit()}),p.Kb(15,"ion-icon",10),p.Nb(),p.Nb(),p.Ob(16,"form",11),p.Wb("ngSubmit",function(){return t.submit()}),p.Ob(17,"ion-card",12),p.Ob(18,"p"),p.Ob(19,"ion-item",13),p.Kb(20,"ion-icon",14),p.lc(21),p.Nb(),p.Nb(),p.Ob(22,"ion-card",15),p.kc(23,ye,6,5,"ion-item",16),p.kc(24,Ie,7,4,"ion-item",16),p.Nb(),p.Nb(),p.Ob(25,"ion-card",12),p.Ob(26,"p"),p.Ob(27,"ion-item",13),p.Kb(28,"ion-icon",14),p.lc(29),p.Nb(),p.Nb(),p.Ob(30,"ion-card",15),p.Ob(31,"ion-item",15),p.Kb(32,"ion-textarea",17),p.Nb(),p.kc(33,fe,4,2,"ion-card",18),p.Nb(),p.Nb(),p.Nb(),p.Kb(34,"div",19),p.Nb()),2&e){const e=p.fc(11);p.bc("appScrollTracker",e),p.zb(3),p.nc(" ",t.stringKey.UPDATE_REVIEW," "),p.zb(3),p.mc(t.stringKey.CANCEL),p.zb(3),p.mc(t.stringKey.SAVE),p.zb(3),p.bc("title",t.stringKey.UPDATE_REVIEW)("info",t.stringKey.REVIEW_INFO),p.zb(3),p.bc("src",t.stringKey.ICON_SAVE),p.zb(1),p.bc("formGroup",t.formGroup),p.zb(4),p.bc("src",t.stringKey.ICON_SLIDER),p.zb(1),p.nc(" ",t.stringKey.FORM_INFO_REVIEWER_ACTIVITY_ACHIEVED_FACT," "),p.zb(2),p.bc("ngIf",t.passedActivityReview.activityMeasurementType==t.activityMeasurementTypeEnum.Bool),p.zb(1),p.bc("ngIf",t.passedActivityReview.activityMeasurementType==t.activityMeasurementTypeEnum.Num),p.zb(4),p.bc("src",t.stringKey.ICON_CREATE),p.zb(1),p.nc(" ",t.stringKey.FORM_INFO_ACTIVITY_REVIEW_COMMENT," "),p.zb(3),p.bc("placeholder",t.stringKey.FORM_PLACEHOLDER_COMMENT),p.zb(1),p.bc("ngIf",t.reviewerComment.invalid&&t.reviewerComment.touched)}},directives:[n.u,j.a,n.Q,n.O,n.k,n.j,n.o,U.a,n.q,n.r,n.v,k.m,k.h,k.c,n.l,n.x,s.j,n.N,n.cb,k.g,k.b,n.y,n.P,n.d,k.j,n.E,n.bb],styles:[""]}),e})();function Ee(e,t){if(1&e&&p.Kb(0,"app-no-data",3),2&e){const e=p.Yb();p.bc("reviewer",!0)("text",e.stringKey.NO_DATA_PROJECT_REVIEWER)}}function Re(e,t){if(1&e&&p.Kb(0,"app-custom-fields",10),2&e){const e=p.Yb().$implicit,t=p.Yb(2);p.bc("data",t.showResult(e))}}function Ne(e,t){if(1&e&&(p.Ob(0,"ion-card"),p.Kb(1,"app-work-progress",11),p.Nb()),2&e){const e=p.Yb().$implicit;p.zb(1),p.bc("activity",e)("resultValue",e.achievedResultValue)}}function Te(e,t){1&e&&p.Kb(0,"app-custom-fields",12),2&e&&p.bc("noData",!0)}function Ae(e,t){if(1&e&&p.Kb(0,"app-custom-fields",10),2&e){const e=p.Yb().$implicit;p.bc("data",e.reviewerComment)}}function Ce(e,t){1&e&&p.Kb(0,"app-custom-fields",12),2&e&&p.bc("noData",!0)}function Se(e,t){if(1&e){const e=p.Pb();p.Ob(0,"div"),p.Ob(1,"app-panel-header",5),p.Wb("event",function(){p.gc(e);const i=t.$implicit;return p.Yb(2).openReviewerOptions(i)}),p.Nb(),p.Ob(2,"ion-grid"),p.Ob(3,"ion-row"),p.Ob(4,"ion-col",6),p.Ob(5,"ion-card"),p.Kb(6,"app-panel-header",0),p.kc(7,Re,1,1,"app-custom-fields",7),p.kc(8,Ne,2,2,"ion-card",2),p.kc(9,Te,1,1,"app-custom-fields",8),p.Nb(),p.Nb(),p.Ob(10,"ion-col",9),p.Ob(11,"ion-card"),p.Kb(12,"app-panel-header",0),p.kc(13,Ae,1,1,"app-custom-fields",7),p.kc(14,Ce,1,1,"app-custom-fields",8),p.Nb(),p.Nb(),p.Nb(),p.Nb(),p.Nb()}if(2&e){const e=t.$implicit,i=p.Yb(2);p.zb(1),p.bc("panelTitle",i.getUserFullName(e.reviewerUserFirstName,e.reviewerUserLastName))("panelIcon",i.stringKey.ICON_REVIEWER)("panelColor",i.stringKey.COLOR_LIGHT)("eventIcon",i.stringKey.ICON_MORE)("isEventRequired",!0),p.zb(5),p.bc("panelTitle",i.stringKey.VERIFIED_RESULT)("panelIcon",i.stringKey.ICON_VERIFIED_RESULT)("panelColor",i.stringKey.COLOR_LIGHT),p.zb(1),p.bc("ngIf",e.achievedResultValue),p.zb(1),p.bc("ngIf",e.achievedResultValue),p.zb(1),p.bc("ngIf",!e.achievedResultValue),p.zb(3),p.bc("panelTitle",i.stringKey.REVIEWER_COMMENT)("panelIcon",i.stringKey.ICON_COMMENT)("panelColor",i.stringKey.COLOR_LIGHT),p.zb(1),p.bc("ngIf",e.reviewerComment),p.zb(1),p.bc("ngIf",!e.reviewerComment)}}function we(e,t){if(1&e&&(p.Ob(0,"div"),p.kc(1,Se,15,16,"div",4),p.Nb()),2&e){const e=p.Yb();p.zb(1),p.bc("ngForOf",e.activityReviews)}}let De=(()=>{class e extends _.a{constructor(e,t,i,s,r){super(e),this.localStorageService=t,this.loadingService=i,this.projectActivityReviewerService=s,this.alertService=r,this.hasData=!1,this.event=new p.o}ngOnInit(){this.activeUserId(),this._projectId=this.activatedRoute.snapshot.paramMap.get("projectId"),this._activityId=this.activatedRoute.snapshot.paramMap.get("activityId")}ngOnDestroy(){super.ngOnDestroy()}activeUserId(){return Object(I.a)(this,void 0,void 0,function*(){this.localStorageService.getActiveUserId().pipe(Object(R.a)(this.unsubscribe)).subscribe(e=>{this._loggedInUser=e})})}showResult(e){return e.activityMeasurementType==W.a.Bool?this.stringKey.ACHIEVED:`${e.achievedResultValue.toString()} ${e.activityResultType}`}openReviewerOptions(e){return Object(I.a)(this,void 0,void 0,function*(){const t=yield this.actionSheetController.create({header:this.stringKey.CHOOSE_YOUR_ACTION,buttons:[{text:this.stringKey.UPDATE+" "+this.stringKey.REVIEWER_COMMENT,icon:this.stringKey.ICON_EDIT,handler:()=>{this.addEditReview(e)}},{text:this.stringKey.DELETE+" "+this.stringKey.REVIEWER,icon:this.stringKey.ICON_DELETE,handler:()=>{this.delete(e)}},{text:this.stringKey.CANCEL,icon:this.stringKey.ICON_CANCEL,handler:()=>{}}]});yield t.present()})}addEditReview(e){return Object(I.a)(this,void 0,void 0,function*(){if(this._loggedInUser==e.reviewerUserId){const t={userId:this._loggedInUser,projectId:this._projectId,activityId:this._activityId,activityReviewId:e.activityReviewId,achievedResultValue:e.achievedResultValue,reviewerUserId:e.reviewerUserId,reviewerComment:e.reviewerComment,activityMeasurementType:e.activityMeasurementType,activityResultType:e.activityResultType,criteriaPoorValue:e.criteriaPoorValue,criteriaOutstandingValue:e.criteriaOutstandingValue,characteristicsHigherBetter:e.characteristicsHigherBetter,operationType:`${f.a.Edit}`},i=yield this.modalController.create({component:_e,componentProps:{data:t}});return i.onDidDismiss().then(e=>{this._modalData=e.data,this._modalData.cancelled||this.event.emit()}),yield i.present()}this.alertService.presentBasicAlert(this.stringKey.ALERT_NO_SAME_REVIEWER)})}delete(e){return Object(I.a)(this,void 0,void 0,function*(){const t=yield this.alertController.create({header:this.stringKey.CONFIRM_ACTION,message:this.stringKey.ALERT_DELETE,buttons:[{text:this.stringKey.CANCEL,handler:()=>{}},{text:this.stringKey.YES,handler:()=>Object(I.a)(this,void 0,void 0,function*(){yield this.deleteReviewer(e)})}]});yield t.present()})}deleteReviewer(e){return Object(I.a)(this,void 0,void 0,function*(){this.loadingService.present(`${this.stringKey.API_REQUEST_MESSAGE_6}`),this.projectActivityReviewerService.projectActivityReviewerCrud({userId:this._loggedInUser,projectId:this._projectId,activityId:this._activityId,activityReviewId:e.activityReviewId,reviewerUserId:e.reviewerUserId,operationType:f.a.Delete}).pipe(Object(R.a)(this.unsubscribe)).subscribe(e=>Object(I.a)(this,void 0,void 0,function*(){yield this.loadingService.dismiss(),e.success&&(yield this.presentToast(e.message),this.event.emit())}),e=>Object(I.a)(this,void 0,void 0,function*(){yield this.loadingService.dismiss()}))})}}return e.\u0275fac=function(t){return new(t||e)(p.Jb(p.t),p.Jb(K.a),p.Jb(V.a),p.Jb(z),p.Jb(A.a))},e.\u0275cmp=p.Db({type:e,selectors:[["app-reviewer-review"]],inputs:{activityReviews:"activityReviews",hasData:"hasData",allowAction:"allowAction"},outputs:{event:"event"},features:[p.wb],decls:4,vars:5,consts:[[3,"panelTitle","panelIcon","panelColor"],[3,"reviewer","text",4,"ngIf"],[4,"ngIf"],[3,"reviewer","text"],[4,"ngFor","ngForOf"],[3,"panelTitle","panelIcon","panelColor","eventIcon","isEventRequired","event"],["size-lg","4","size-md","4","size-sm","4","size","12"],[3,"data",4,"ngIf"],[3,"noData",4,"ngIf"],["size-lg","8","size-md","8","size-sm","8","size","12"],[3,"data"],[3,"activity","resultValue"],[3,"noData"]],template:function(e,t){1&e&&(p.Ob(0,"ion-card"),p.Kb(1,"app-panel-header",0),p.kc(2,Ee,1,2,"app-no-data",1),p.kc(3,we,2,1,"div",2),p.Nb()),2&e&&(p.zb(1),p.bc("panelTitle",t.stringKey.REVIEW_DETAILS)("panelIcon",t.stringKey.ICON_ACTIVITY_REVIEW)("panelColor",t.stringKey.COLOR_MEDIUM),p.zb(1),p.bc("ngIf",!t.hasData),p.zb(1),p.bc("ngIf",t.hasData))},directives:[n.l,L.a,s.j,q.a,s.i,n.t,n.I,n.n,P.a,ce.a],styles:[""]}),e})();function Ke(e,t){if(1&e&&p.Kb(0,"app-no-data",15),2&e){const e=p.Yb();p.bc("credibility",!0)("text",e.stringKey.NO_DATA_CREDIBILITY)}}function Me(e,t){if(1&e){const e=p.Pb();p.Mb(0),p.Ob(1,"app-panel-header",16),p.Wb("click",function(){p.gc(e);const t=p.Yb();return t.editProjectActivity(t.activity)}),p.Nb(),p.Ob(2,"ion-grid"),p.Ob(3,"ion-row"),p.Ob(4,"ion-col",17),p.Ob(5,"ion-card"),p.Kb(6,"app-panel-header",18),p.Kb(7,"app-custom-fields",19),p.Nb(),p.Nb(),p.Ob(8,"ion-col",17),p.Ob(9,"ion-card"),p.Kb(10,"app-panel-header",20),p.Kb(11,"app-custom-fields",19),p.Nb(),p.Nb(),p.Ob(12,"ion-col",21),p.Kb(13,"app-measurement-scale",22),p.Nb(),p.Ob(14,"ion-col",21),p.Ob(15,"app-assignee-self-review",23),p.Wb("event",function(){return p.gc(e),p.Yb().loadData()}),p.Nb(),p.Nb(),p.Ob(16,"ion-col",21),p.Ob(17,"app-reviewer-review",24),p.Wb("event",function(){return p.gc(e),p.Yb().loadData()}),p.Nb(),p.Nb(),p.Nb(),p.Nb(),p.Lb()}if(2&e){const e=p.Yb();p.zb(1),p.bc("panelTitle",e.activity.activityName)("panelIcon",e.stringKey.ICON_ACTIVITY)("panelColor",e.stringKey.COLOR_SECONDARY)("eventIcon",e.stringKey.ICON_EDIT)("isEventRequired",!0),p.zb(5),p.bc("panelTitle",e.stringKey.MEASUREMENT_TYPE)("panelIcon",e.stringKey.ICON_RESULT)("panelColor",e.stringKey.COLOR_MEDIUM),p.zb(1),p.bc("data",e.activity.activityResultType),p.zb(3),p.bc("panelTitle",e.stringKey.WEIGHT_IN_P)("panelIcon",e.stringKey.ICON_WEIGHT)("panelColor",e.stringKey.COLOR_MEDIUM),p.zb(1),p.bc("data",e.activity.activityWeight.toString()),p.zb(2),p.bc("activity",e.activity),p.zb(2),p.bc("activity",e.activity)("allowAction",!0),p.zb(2),p.bc("activityReviews",e.activityReviews)("hasData",e.hasReviewsData)("allowAction",!0)}}const ze=[{path:"",component:(()=>{class e extends _.a{constructor(e,t,i,s){super(e),this.localStorageService=t,this.projectActivityService=i,this.loadingService=s,this._hasData=!1,this._hasReviewsData=!1,this.activityMeasurementTypeEnum=W.a}set breadCrumb(e){this._breadCrumb=e}get breadCrumb(){return this._breadCrumb}set hasData(e){this._hasData=e}get hasData(){return this._hasData}set activity(e){this._activity=e}get activity(){return this._activity}set activityReviews(e){this._activityReviews=e}get activityReviews(){return this._activityReviews}set hasReviewsData(e){this._hasReviewsData=e}get hasReviewsData(){return this._hasReviewsData}activeUserId(){return Object(I.a)(this,void 0,void 0,function*(){this.localStorageService.getActiveUserId().pipe(Object(R.a)(this.unsubscribe)).subscribe(e=>{this._loggedInUser=e})})}ngOnInit(){this.activeUserId(),this._projectId=this.activatedRoute.snapshot.paramMap.get("projectId"),this._activityId=this.activatedRoute.snapshot.paramMap.get("activityId")}ionViewDidEnter(){this.loadData()}ngOnDestroy(){super.ngOnDestroy()}loadData(){return Object(I.a)(this,void 0,void 0,function*(){this.loadingService.present(`${E.a.API_REQUEST_MESSAGE_1}`),this.projectActivityService.getProjectActivityDetails({projectId:this._projectId,userId:this._loggedInUser,activityId:this._activityId}).pipe(Object(R.a)(this.unsubscribe)).subscribe(e=>Object(I.a)(this,void 0,void 0,function*(){yield this.loadingService.dismiss(),e.success&&(this._projectActivityModel=e.data,this._hasData=!0,yield this.generateBreadcrumb(),this._activity=this._projectActivityModel.activityDetails,this._projectActivityModel.reviewDetails.success?(this._activityReviews=this._projectActivityModel.reviewDetails.data,this._hasReviewsData=!0):this._hasReviewsData=!1)}))})}generateBreadcrumb(){var e;return Object(I.a)(this,void 0,void 0,function*(){let t=null===(e=this._projectActivityModel.projectDetails)||void 0===e?void 0:e.projectName;this._breadCrumb=[t,this.stringKey.PROJECT_ACTIVITY]})}editProjectActivity(e){return Object(I.a)(this,void 0,void 0,function*(){e.userId=this._loggedInUser,e.projectId=this._projectId,e.operationType=f.a.Edit;const t=yield this.modalController.create({component:J.a,componentProps:{data:e}});return t.onDidDismiss().then(e=>{this._modalData=e.data,this._modalData.cancelled||this.loadData()}),yield t.present()})}addReviewer(){return Object(I.a)(this,void 0,void 0,function*(){const e={userId:this._loggedInUser,projectId:this._projectId,activityId:this._activityId,operationType:`${f.a.Create}`},t=yield this.modalController.create({component:B,componentProps:{data:e}});return t.onDidDismiss().then(e=>{this._modalData=e.data,this._modalData.cancelled||this.loadData()}),yield t.present()})}}return e.\u0275fac=function(t){return new(t||e)(p.Jb(p.t),p.Jb(K.a),p.Jb($.a),p.Jb(V.a))},e.\u0275cmp=p.Db({type:e,selectors:[["project-users"]],features:[p.wb],decls:20,vars:8,consts:[[3,"appScrollTracker"],["color","primary"],["slot","start"],["slot","end",3,"click"],["slot","start",3,"src"],["scrollEvents","true"],["scrollArea",""],[3,"title","info"],["slot","fixed",3,"ionRefresh"],["slot","fixed","vertical","bottom","horizontal","end"],["color","dark",3,"click"],[3,"src"],[3,"credibility","text",4,"ngIf"],[4,"ngIf"],["id","dum-height"],[3,"credibility","text"],[3,"panelTitle","panelIcon","panelColor","eventIcon","isEventRequired","click"],["size-lg","6","size-md","6","size-sm","6","size","12"],[3,"panelTitle","panelIcon","panelColor"],[3,"data"],["eventIcon","stringKey.ICON_MORE",3,"panelTitle","panelIcon","panelColor"],["size-lg","12","size-md","12","size-sm","12","size","12"],[3,"activity"],[3,"activity","allowAction","event"],[3,"activityReviews","hasData","allowAction","event"]],template:function(e,t){if(1&e&&(p.Ob(0,"ion-header",0),p.Ob(1,"ion-toolbar",1),p.Ob(2,"ion-title"),p.lc(3),p.Nb(),p.Ob(4,"ion-buttons",2),p.Kb(5,"ion-menu-button"),p.Kb(6,"ion-back-button"),p.Nb(),p.Ob(7,"ion-buttons",3),p.Wb("click",function(){return t.loadData()}),p.Kb(8,"ion-icon",4),p.Nb(),p.Nb(),p.Nb(),p.Ob(9,"ion-content",5,6),p.Kb(11,"app-page-info-title",7),p.Ob(12,"ion-refresher",8),p.Wb("ionRefresh",function(e){return t.doRefresh(e)}),p.Kb(13,"ion-refresher-content"),p.Nb(),p.Ob(14,"ion-fab",9),p.Ob(15,"ion-fab-button",10),p.Wb("click",function(){return t.addReviewer()}),p.Kb(16,"ion-icon",11),p.Nb(),p.Nb(),p.kc(17,Ke,1,2,"app-no-data",12),p.kc(18,Me,18,19,"ng-container",13),p.Kb(19,"div",14),p.Nb()),2&e){const e=p.fc(10);p.bc("appScrollTracker",e),p.zb(3),p.nc(" ",t.stringKey.ACTIVITY_REVIEW," "),p.zb(5),p.bc("src",t.stringKey.ICON_REFRESH),p.zb(3),p.bc("title",t.stringKey.ACTIVITY_REVIEW)("info",t.stringKey.ACTIVITY_REVIEW_INFO),p.zb(5),p.bc("src",t.stringKey.ICON_ADD),p.zb(1),p.bc("ngIf",!t.hasData),p.zb(1),p.bc("ngIf",t.hasData)}},directives:[n.u,j.a,n.Q,n.O,n.k,n.B,n.h,n.i,n.v,n.o,U.a,n.F,n.G,n.q,n.r,s.j,q.a,L.a,n.t,n.I,n.n,n.l,P.a,ee,he,De],styles:[""]}),e})()}];let Ve=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=p.Hb({type:e}),e.\u0275inj=p.Gb({imports:[[s.b,n.R,c.a,u,a.a,v.a,O,h.a,d.a,b.a,m.a,o.a,l.a,r.k.forChild(ze)]]}),e})()}}]);